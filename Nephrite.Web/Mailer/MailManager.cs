using System; using System.Configuration; using System.IO; using System.Collections.Generic; using System.Linq; using System.Text; using System.Text.RegularExpressions; using Nephrite.Web;  namespace Nephrite.Web.Mailer { 	public class MailManager 	{ 		public static string SendNotify(string email, string mailTemplateName, object viewData) 		{ 			var dc = A.Model as IDC_Mailer; 			var mt = dc.IMailTemplate.SingleOrDefault(o => o.Title == mailTemplateName); 			CustomControlManager.Register("mailtemplate_" + mt.MailTemplateID.ToString(), DateTime.Now, mt.TemplateSubject +"|"+mt.TemplateBody, viewData.GetType()); 			string text = CustomControlManager.Render("mailtemplate_" + mt.MailTemplateID.ToString(), viewData); 			string body = text.Split('|')[1]; 			string subject = text.Split('|')[0];  			IMailMessage mess = dc.NewIMailMessage(); 			mess.Recipients = email; 			mess.Subject = subject; 			mess.Body = body;  			dc.IMailMessage.InsertOnSubmit(mess); 			 			return text;	 		} 	} }